<%= render partial: 'details' %>

<% if current_user.participating? @exchange %>
  <% assignment = current_user.elf_assignments.where(exchange_id: @exchange.id).first %>
  <% if assignment.recipient.nil? %>
    <h4><%= t('assignment.unassigned') %></h4>
  <% else %>
    <h3>Recipient Details</h3>
    <%= render partial: 'users/details', locals: { user: assignment.recipient.decorate } %>
  <% end %>
<% end %>

<% if can? :manage, @exchange %>
  <h3>Participants <small><%=@exchange.participants.length%></small></h3>
  <ul class="list-unstyled">
  <% @exchange.participants.sort_by(&:name).each do |participant| %>
    <li>
      <%= content_tag(:span, class: participant.address.present? ? 'text-success' : 'text-danger') do %>
        <%= glyph(:envelope, {}) %>
      <% end %>
      <%= link_to_if current_user.admin?, participant.name, participant %>
    </li>
  <% end %>
  </ul>
  <%= link_to t('assignment.shuffle'), shuffle_exchange_path(@exchange), method: :post, class: 'btn btn-primary' %>
<% end %>
